#!/bin/sh

MONWIDTH=$(wattr w `lsw -r`)

curtime() {
	timedelta=3
	python -c "import datetime; date = datetime.datetime.now() + datetime.timedelta(minutes=$timedelta); print(date.strftime('%d.%m  %H:%M'))"
}

batstat() {
	test $(bat -s) = "Charging" && echo + || echo ' '
}

vpnstatus() {
	test $(vpn) = "up" && echo +
}

# left bar
while :; do
	printf "%s%3s  %3d%s %s\n" "%{c}" "$(vol)" "$(bat)" "$(batstat)" "$(vpnstatus)"
	sleep 1s
done |\
mybar 0 "bar" &

# right bar
while :; do
	printf "%s%s\n" "%{c}" "$(curtime)"
	sleep 5s
done |\
mybar $((MONWIDTH - 150)) "bar" &
